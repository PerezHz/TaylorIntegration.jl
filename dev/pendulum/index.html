<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Jet transport: the simple pendulum ¬∑ TaylorIntegration.jl</title><meta name="title" content="Jet transport: the simple pendulum ¬∑ TaylorIntegration.jl"/><meta property="og:title" content="Jet transport: the simple pendulum ¬∑ TaylorIntegration.jl"/><meta property="twitter:title" content="Jet transport: the simple pendulum ¬∑ TaylorIntegration.jl"/><meta name="description" content="Documentation for TaylorIntegration.jl."/><meta property="og:description" content="Documentation for TaylorIntegration.jl."/><meta property="twitter:description" content="Documentation for TaylorIntegration.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">TaylorIntegration.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Background</span><ul><li><a class="tocitem" href="../taylor_method/">Taylor&#39;s method</a></li><li><a class="tocitem" href="../lyapunov_spectrum/">Lyapunov spectrum</a></li><li><a class="tocitem" href="../jet_transport/">Jet transport</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../simple_example/">Infinity in finite time</a></li><li><a class="tocitem" href="../kepler/">The Kepler problem</a></li><li><a class="tocitem" href="../lorenz_lyapunov/">Lyapunov spectrum of Lorenz system</a></li><li class="is-active"><a class="tocitem" href>Jet transport: the simple pendulum</a></li><li><a class="tocitem" href="../root_finding/">Poincar√© maps</a></li><li><a class="tocitem" href="../common/">Interoperability with <code>DifferentialEquations.jl</code></a></li></ul></li><li><a class="tocitem" href="../taylorize/">Optimizing: <code>@taylorize</code></a></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Jet transport: the simple pendulum</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Jet transport: the simple pendulum</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/PerezHz/TaylorIntegration.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/PerezHz/TaylorIntegration.jl/blob/main/docs/src/pendulum.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="pendulum"><a class="docs-heading-anchor" href="#pendulum">Jet transport: the simple pendulum</a><a id="pendulum-1"></a><a class="docs-heading-anchor-permalink" href="#pendulum" title="Permalink"></a></h1><p>In this example we illustrate the use of jet transport techniques in <code>TaylorIntegration.jl</code> for the simple pendulum. We propagate a neighborhood <span>$U_0$</span> around an initial condition <span>$q_0$</span> parametrized by the sum <span>$q_0+\xi$</span>, where <span>$q_0=(x_0,p_0)$</span> represents the coordinates of the initial condition in phase space, and <span>$\xi=(\xi_1,\xi_2)$</span> represents an small variation with respect to this initial condition. We re-interpret each component of the sum <span>$q_0+\xi$</span> as a multivariate polynomial in the variables <span>$\xi_1$</span> and <span>$\xi_2$</span>; below, the maximum order of the multivariate polynomial is fixed at 8. We propagate these multivariate polynomials in time using Taylor&#39;s method.</p><p>The simple pendulum is defined by the Hamiltonian <span>$H(x, p) = \frac{1}{2}p^2-\cos x$</span>; the corresponding equations of motion are given by</p><p class="math-container">\[\begin{aligned}
\dot{x} &amp; = p, \\
\dot{p} &amp; = -\sin x.
\end{aligned}\]</p><p>We integrate this problem for a neighborhood <span>$U_0$</span> around the initial condition <span>$q_0 = (x(t_0), p(t_0)) = (x_0, p_0)$</span>. For concreteness we take <span>$p_0=0$</span> and choose <span>$x_0$</span> such that the pendulum librates; that is, we will choose a numerical value for the energy <span>$E=H(x_0,p_0)=-\cos x_0$</span> such that the pendulum&#39;s motion in phase space is &quot;below&quot; (inside) the region bounded by the separatrix. In this case, the libration period <span>$T$</span> of the pendulum is</p><p class="math-container">\[T=\frac{4}{\sqrt{2}}\int_0^{x_0}\frac{dx}{\sqrt{\cos x_0-\cos x}},\]</p><p>which can be expressed in terms of the complete elliptic integral of the first kind, <span>$K$</span>:</p><p class="math-container">\[T=4K(\sin(x_0/2)).\]</p><p>The Hamiltonian for the simple pendulum is:</p><pre><code class="language-julia hljs">H(x) = 0.5x[2]^2-cos(x[1])</code></pre><p>The equations of motion are:</p><pre><code class="language-julia hljs">function pendulum!(dx, x, p, t)
    dx[1] = x[2]
    dx[2] = -sin(x[1])
end</code></pre><p>We define the <code>TaylorN</code> variables necessary to perform the jet transport; <code>varorder</code> represents the maximum order of expansion in the variations <span>$\xi$</span>.</p><pre><code class="language-julia hljs">const varorder = 8
using TaylorIntegration
Œæ = set_variables(&quot;Œæ&quot;, numvars=2, order=varorder)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{TaylorN{Float64}}:
  1.0 Œæ‚ÇÅ + ùí™(‚Äñx‚Äñ‚Åπ)
  1.0 Œæ‚ÇÇ + ùí™(‚Äñx‚Äñ‚Åπ)</code></pre><p>Note that <code>TaylorSeries.jl</code> is <code>@reexport</code>-ed internally by <code>TaylorIntegration.jl</code>.</p><p>The nominal initial condition is:</p><pre><code class="language-julia hljs">q0 = [1.3, 0.0]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Float64}:
 1.3
 0.0</code></pre><p>The corresponding initial value of the energy is:</p><pre><code class="language-julia hljs">H0 = H(q0)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-0.26749882862458735</code></pre><p>The parametrization of the neighborhood <span>$U_0$</span> is represented by</p><pre><code class="language-julia hljs">q0TN = q0 .+ Œæ</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{TaylorN{Float64}}:
  1.3 + 1.0 Œæ‚ÇÅ + ùí™(‚Äñx‚Äñ‚Åπ)
        1.0 Œæ‚ÇÇ + ùí™(‚Äñx‚Äñ‚Åπ)</code></pre><p>To understand how the jet transport technique works, we shall evaluate the Hamiltonian at <span>$q_0+\xi$</span> in order to obtain the 8-th order Taylor expansion of the Hamiltonian with respect to the variations <span>$\xi$</span>, around the initial condition <span>$q_0$</span>:</p><pre><code class="language-julia hljs">H(q0TN)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"> - 0.26749882862458735 + 0.963558185417193 Œæ‚ÇÅ + 0.13374941431229367 Œæ‚ÇÅ¬≤ + 0.5 Œæ‚ÇÇ¬≤ - 0.1605930309028655 Œæ‚ÇÅ¬≥ - 0.011145784526024473 Œæ‚ÇÅ‚Å¥ + 0.008029651545143275 Œæ‚ÇÅ‚Åµ + 0.0003715261508674824 Œæ‚ÇÅ‚Å∂ - 0.00019118217964626843 Œæ‚ÇÅ‚Å∑ - 6.634395551205043e-6 Œæ‚ÇÅ‚Å∏ + ùí™(‚Äñx‚Äñ‚Åπ)</code></pre><p>Note that the 0-th order term of the expression above is equal to the value <code>H(q0)</code>, as expected.</p><p>Below, we set some parameters for the Taylor integration. We use a method of <code>taylorinteg</code> which returns the solution at <code>t0</code>, <code>t0+integstep</code>, <code>t0+2integstep</code>,...,<code>tmax</code>, where <code>t0</code> and <code>tmax</code> are the initial and final times of integration, whereas <code>integstep</code> is a time interval chosen by the user; we use the variable <code>tv = t0:integstep:tmax</code> for this purpose and choose <code>integstep</code> as <span>$\frac{T}{8}$</span>.</p><pre><code class="language-julia hljs">order = 28     #the order of the Taylor expansion wrt time
abstol = 1e-20 #the absolute tolerance of the integration
using Elliptic # we use Elliptic.jl to evaluate the elliptic integral K
T = 4*Elliptic.K(sin(q0[1]/2)^2) #the libration period
t0 = 0.0        #the initial time
tmax = 6T       #the final time
integstep = T/8 #the time interval between successive evaluations of the solution vector</code></pre><p>We perform the Taylor integration using the initial condition <code>x0TN</code>, during 6 periods of the pendulum (i.e., <span>$6T$</span>), exploiting multiple dispatch:</p><pre><code class="language-julia hljs">tv = t0:integstep:tmax # the times at which the solution will be evaluated
sol = taylorinteg(pendulum!, q0TN, tv, order, abstol)</code></pre><p>The integration above <em>works</em> for any initial neighborhood <span>$U_0$</span> around the nominal initial condition <span>$q_0$</span>, provided it is sufficiently small.</p><p>We will consider the particular case where <span>$U_0$</span> is a disk of radius <span>$r = 0.05$</span>, centered at <span>$q_0$</span>; that is <span>$U_0=\{ q_0+\xi:\xi=(r\cos\phi,r\sin\phi); \phi\in[0,2\pi) \}$</span> for a given radius <span>$r&gt;0$</span>. We will denote by <span>$U_t$</span> the propagation of the initial neighborhood <span>$U_0$</span> evaluated at time <span>$t$</span>. Also, we denote by <span>$q(t)$</span> the coordinates of the nominal solution at time <span>$t$</span>: <span>$q(t)=(x(t),p(t))$</span>. Likewise, we will denote the propagation at time <span>$t$</span> of a given initial variation <span>$\xi_0$</span> by <span>$\xi(t)$</span>. Then, we can compute the propagation of the boundary <span>$\partial U_t$</span> of the neighborhood <span>$U_t$</span>.</p><pre><code class="language-julia hljs">polar2cart(r, œï) = [r*cos(œï), r*sin(œï)] # convert radius r and angle œï to cartesian coordinates
r = 0.05 #the radius of the neighborhood
œï = 0.0:0.1:(2œÄ+0.1) #the values of the angle
Œæv = polar2cart.(r, œï)</code></pre><p>We evaluate the jet at <span>$\partial U_{x(t)}$</span> (the boundary of <span>$U_{x(t)}$</span>) at each value of the solution array <code>sol.x</code>; we organize these values such that we can plot them later:</p><pre><code class="language-julia hljs">xjet_plot = map(Œª-&gt;Œª.(Œæv), sol.x[:,1])
pjet_plot = map(Œª-&gt;Œª.(Œæv), sol.x[:,2])</code></pre><p>Above, we have exploited the fact that <code>Array{TaylorN{Float64}}</code> variables are callable objects. Now, we evaluate the jet at the nominal solution, which corresponds to <span>$\xi=(0,0)$</span>, at each value of the solution vector <code>sol.x</code>:</p><pre><code class="language-julia hljs">x_nom = sol.x[:,1]()
p_nom = sol.x[:,2]()</code></pre><p>Finally, we shall plot the nominal solution (black dots), as well as the evolution of the neighborhood <span>$U_0$</span> (in colors), each <span>$\frac{1}{8}$</span>th of a period <span>$T$</span>. The initial condition corresponds to the black dot situated at <span>$q_0=(1.3,0)$</span></p><pre><code class="language-julia hljs">using Plots
plot( xjet_plot, pjet_plot,
    xaxis=(&quot;x&quot;,), yaxis=(&quot;p&quot;,),
    title=&quot;Simple pendulum phase space&quot;,
    leg=false, aspect_ratio=1.0
)
scatter!( x_nom, p_nom,
    color=:black,
    m=(1,2.8,stroke(0))
)</code></pre><img src="f5e38467.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../lorenz_lyapunov/">¬´ Lyapunov spectrum of Lorenz system</a><a class="docs-footer-nextpage" href="../root_finding/">Poincar√© maps ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Tuesday 6 August 2024 12:10">Tuesday 6 August 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

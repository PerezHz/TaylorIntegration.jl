<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Infinity in finite time · TaylorIntegration.jl</title><meta name="title" content="Infinity in finite time · TaylorIntegration.jl"/><meta property="og:title" content="Infinity in finite time · TaylorIntegration.jl"/><meta property="twitter:title" content="Infinity in finite time · TaylorIntegration.jl"/><meta name="description" content="Documentation for TaylorIntegration.jl."/><meta property="og:description" content="Documentation for TaylorIntegration.jl."/><meta property="twitter:description" content="Documentation for TaylorIntegration.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">TaylorIntegration.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Background</span><ul><li><a class="tocitem" href="../taylor_method/">Taylor&#39;s method</a></li><li><a class="tocitem" href="../lyapunov_spectrum/">Lyapunov spectrum</a></li><li><a class="tocitem" href="../jet_transport/">Jet transport</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href>Infinity in finite time</a><ul class="internal"><li><a class="tocitem" href="#Illustration-of-the-method"><span>Illustration of the method</span></a></li><li><a class="tocitem" href="#implementation_ex1"><span>Implementation</span></a></li></ul></li><li><a class="tocitem" href="../kepler/">The Kepler problem</a></li><li><a class="tocitem" href="../lorenz_lyapunov/">Lyapunov spectrum of Lorenz system</a></li><li><a class="tocitem" href="../pendulum/">Jet transport: the simple pendulum</a></li><li><a class="tocitem" href="../root_finding/">Poincaré maps</a></li><li><a class="tocitem" href="../common/">Interoperability with <code>DifferentialEquations.jl</code></a></li></ul></li><li><a class="tocitem" href="../taylorize/">Optimizing: <code>@taylorize</code></a></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Infinity in finite time</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Infinity in finite time</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/PerezHz/TaylorIntegration.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/PerezHz/TaylorIntegration.jl/blob/main/docs/src/simple_example.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="example1"><a class="docs-heading-anchor" href="#example1">Infinity in finite time</a><a id="example1-1"></a><a class="docs-heading-anchor-permalink" href="#example1" title="Permalink"></a></h1><h2 id="Illustration-of-the-method"><a class="docs-heading-anchor" href="#Illustration-of-the-method">Illustration of the method</a><a id="Illustration-of-the-method-1"></a><a class="docs-heading-anchor-permalink" href="#Illustration-of-the-method" title="Permalink"></a></h2><p>We shall illustrate first with a simple example how the method explicitly constructs the solution, and how to use the package to obtain it.</p><p>We consider the differential equation given by</p><p class="math-container">\[\dot{x} = x^2,\tag{1}\]</p><p>with the initial condition <span>$x(0)=x_0$</span>, whose exact solution reads</p><p class="math-container">\[x(t) = \frac{x_0}{1-x_0t}.\tag{2}\]</p><p>We shall implement the construction of this example explicitly, which illustrates the way <code>TaylorIntegration.jl</code> is conceived.</p><p>The initial condition defines the 0-th order approximation, i.e., <span>$x(t) = x_0 + \mathcal{O}(t^1)$</span>. We now write the solution as <span>$x(t) = x_0 + x_{[1]}t + \mathcal{O}(t^2)$</span>, and we want to determine <span>$x_{[1]}$</span>. Substituting this solution into the RHS of (1), yields</p><p class="math-container">\[x^2 = x_0^2 + 2 x_0 x_{[1]} t + x_{[1]}^2 t^2 =
 x_0^2 + \mathcal{O}(t^1),\]</p><p>where in the last equality we have kept all terms up to order 0, since we want to determine <span>$x_{[1]}$</span>, and the recursion formula requires for that the 0-th order term of the Taylor expansion of the RHS of the equation of motion. Hence, we have <span>$f_{[0]}=x_0^2$</span>, which using the recursion relation <span>$x_{[k+1]} = f_{[k]}/(k+1)$</span> yields <span>$x_{[1]} = x_0^2$</span>.</p><p>Following the same procedure, we write <span>$x(t) = x_0 + x_{[1]} t + x_{[2]} t^2 + \mathcal{O}(t^3)$</span>, and</p><p class="math-container">\[x^2 = x_0^2 + 2 x_0 x_{[1]} t + \mathcal{O}(t^2),\]</p><p>where we kept all terms up to order 1. We thus have <span>$f_{[1]}=2 x_0 x_{[1]} = 2 x_0^3$</span>, which then yields <span>$x_{[2]} = x_0^3$</span>. Repeating this calculation, we obtain</p><p class="math-container">\[x(t) = x_0 + x_0^2 t + x_0^3 t^2 + \cdots + x_0^{k+1} t^k + \cdots.\tag{3}\]</p><p>The solution given by Eq. (3) is a geometrical series, which is identical to the exact solution, Eq. (2). Yet, it is not obvious from the solution that it is only defined for <span>$t&lt;1/x_0$</span>. To see this, we obtain the step size, as described previously, for the series truncated to order <span>$k$</span>. The Taylor coefficient of order <span>$k$</span> is <span>$x_{[k]}=x_0^{k+1}$</span>, so the time step is</p><p class="math-container">\[h &lt; \Big(\frac{\epsilon_\textrm{tol}}{|x_0^{k+1}|}\Big)^{1/k} =
\frac{\epsilon_\textrm{tol}^{1/k}}{|x_0|^{1+1/k}}.\]</p><p>In the limit <span>$k\to\infty$</span> we obtain <span>$h &lt; h_\textrm{max}=1/x_0$</span>, which is the domain of existence of the exact solution.</p><p>Below, we shall fix a maximum order for the expansion. This entails a truncation error which is somewhat controlled through the absolute tolerance <span>$\epsilon_\textrm{tol}$</span>. The key to a correct use of Taylor&#39;s method is to impose a quite small value of <span>$\epsilon_\textrm{tol}$</span> <em>together</em> with a large enough order of the expansion.</p><h2 id="implementation_ex1"><a class="docs-heading-anchor" href="#implementation_ex1">Implementation</a><a id="implementation_ex1-1"></a><a class="docs-heading-anchor-permalink" href="#implementation_ex1" title="Permalink"></a></h2><p>We shall illustrate how to use <code>TaylorIntegration.jl</code> to integrate Eq. (1) for the initial condition <span>$x(0)=3$</span>. Notice that according to the exact solution Eq. (2), the solution only exists for <span>$t&lt;t_\mathrm{max} =1/3$</span>; in addition, we note that this number can not be represented exactly as a floating-point number.</p><p>We first load the required packages and define a function which represents the equation of motion.</p><pre><code class="language-julia hljs">using TaylorIntegration, Plots
diffeq(x, p, t) = x^2;</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">diffeq (generic function with 1 method)</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>In <code>TaylorIntegration.jl</code> we use the same convention of <a href="http://docs.juliadiffeq.org/stable/tutorials/ode_example.html">DifferentialEquations.jl</a> when writing the function representing the equations of motion.</p></div></div><p>We now integrate the equations of motion using <a href="../api/#TaylorIntegration.taylorinteg"><code>taylorinteg</code></a>; note that, despite of the fact that the solution only exists for <span>$t&lt;t_\textrm{max}$</span>, below we shall <em>try</em> to compute it up to <span>$t_\textrm{end}=0.34$</span>; as we shall see, Taylor&#39;s method takes care of this. For the integration presented below, we use a 25-th series expansion, with <span>$\epsilon_\textrm{tol} = 10^{-20}$</span>, and compute up to 150 integration steps.</p><pre><code class="language-julia hljs">tT, xT = taylorinteg(diffeq, 3.0, 0.0, 0.34, 25, 1e-20, maxsteps=150) ;</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([0.0, 0.04673748724788921, 0.08666964734179776, 0.12082375432218478, 0.15006657642316595, 0.17513029556227688, 0.19663410663971947, 0.21510223893149374, 0.23097901054539446, 0.24464141948580478  …  0.33333323413266813, 0.3333332415691814, 0.33333324842592277, 0.33333325474982284, 0.333333260583874, 0.3333332659674727, 0.3333332709367305, 0.3333332755247577, 0.3333332797619218, 0.33333328367608234], [3.0, 3.489234103211201, 4.054103043097782, 4.705670232152399, 5.456526960261398, 6.3209911395453116, 7.315330336442326, 8.45801187123614, 9.769983062384513, 11.274985019706682  …  1.0080577551241778e7, 1.0897501670640979e7, 1.1777534986335507e7, 1.2725315931854066e7, 1.3745806602465497e7, 1.4844314146377133e7, 1.6026513491543336e7, 1.7298471486640345e7, 1.8666672539102122e7, 2.0138045837674662e7])</code></pre><p>We first note that the last point of the calculation does not exceed <span>$t_\textrm{max}$</span>.</p><pre><code class="language-julia hljs">tT[end]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.33333328367608234</code></pre><p>Increasing the <code>maxsteps</code> parameter pushes <code>tT[end]</code> closer to <span>$t_\textrm{max}$</span> but it actually does not reach this value.</p><p>Figure 1 displays the computed solution as a function of time, in log scale.</p><pre><code class="language-julia hljs">plot(tT, log10.(xT), shape=:circle)
xlabel!(&quot;t&quot;)
ylabel!(&quot;log10(x(t))&quot;)
xlims!(0,0.34)
title!(&quot;Fig. 1&quot;)</code></pre><img src="c0163c15.svg" alt="Example block output"/><p>Clearly, the solution diverges without bound when <span>$t\to t_\textrm{max} = 1/3$</span>, i.e., <span>$x(t)$</span> approaches infinity in finite time.</p><p>Figure 2 shows the relative difference between the numerical and the analytical solution in terms of time.</p><pre><code class="language-julia hljs">exactsol(t, x0) = x0 / (1 - x0 * t)
δxT = abs.(xT .- exactsol.(tT, 3.0)) ./ exactsol.(tT, 3.0);
plot(tT[6:end], log10.(δxT[6:end]), shape=:circle)
xlabel!(&quot;t&quot;)
ylabel!(&quot;log10(dx(t))&quot;)
xlims!(0, 0.4)
title!(&quot;Fig. 2&quot;)</code></pre><img src="a51dfa9f.svg" alt="Example block output"/><p>To put in perspective how good is the constructed solution, we impose (arbitrarily) a relative accuracy of <span>$10^{-13}$</span>; the time until such accuracy is satisfied is given by:</p><pre><code class="language-julia hljs">indx = findfirst(δxT .&gt; 1.0e-13);
esol = exactsol(tT[indx-1],3.0);
tT[indx-1], esol, eps(esol)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(0.3323590833381362, 1026.4305926915836, 2.2737367544323206e-13)</code></pre><p>Note that, the accuracy imposed in terms of the actual value of the exact solution means that the difference of the computed and the exact solution is essentially due to the <code>eps</code> of the computed value.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../jet_transport/">« Jet transport</a><a class="docs-footer-nextpage" href="../kepler/">The Kepler problem »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Saturday 10 February 2024 11:08">Saturday 10 February 2024</span>. Using Julia version 1.10.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

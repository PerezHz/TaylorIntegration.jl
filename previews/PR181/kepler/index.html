<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>The Kepler problem · TaylorIntegration.jl</title><meta name="title" content="The Kepler problem · TaylorIntegration.jl"/><meta property="og:title" content="The Kepler problem · TaylorIntegration.jl"/><meta property="twitter:title" content="The Kepler problem · TaylorIntegration.jl"/><meta name="description" content="Documentation for TaylorIntegration.jl."/><meta property="og:description" content="Documentation for TaylorIntegration.jl."/><meta property="twitter:description" content="Documentation for TaylorIntegration.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">TaylorIntegration.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Background</span><ul><li><a class="tocitem" href="../taylor_method/">Taylor&#39;s method</a></li><li><a class="tocitem" href="../lyapunov_spectrum/">Lyapunov spectrum</a></li><li><a class="tocitem" href="../jet_transport/">Jet transport</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../simple_example/">Infinity in finite time</a></li><li class="is-active"><a class="tocitem" href>The Kepler problem</a></li><li><a class="tocitem" href="../lorenz_lyapunov/">Lyapunov spectrum of Lorenz system</a></li><li><a class="tocitem" href="../pendulum/">Jet transport: the simple pendulum</a></li><li><a class="tocitem" href="../root_finding/">Poincaré maps</a></li><li><a class="tocitem" href="../common/">Interoperability with <code>DifferentialEquations.jl</code></a></li></ul></li><li><a class="tocitem" href="../taylorize/">Optimizing: <code>@taylorize</code></a></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>The Kepler problem</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>The Kepler problem</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/PerezHz/TaylorIntegration.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/PerezHz/TaylorIntegration.jl/blob/main/docs/src/kepler.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="kepler_problem"><a class="docs-heading-anchor" href="#kepler_problem">The Kepler problem</a><a id="kepler_problem-1"></a><a class="docs-heading-anchor-permalink" href="#kepler_problem" title="Permalink"></a></h1><p>The <a href="https://en.wikipedia.org/wiki/Kepler_problem">Kepler problem</a> corresponds to the study of the motion of two bodies which are influenced by their mutual gravitational attraction. In the center of mass and relative coordinates, the problem is reduced to the motion of one body of mass <span>$m = m_1 m_2 / M$</span>, which we shall refer as particle below, attracted gravitationally by another located at rest at the origin of mass <span>$M=m_1+m_2$</span>.</p><p>In cartesian coordinates, the equations of motion can be written as</p><p class="math-container">\[\begin{aligned}
\dot{x} &amp; = v_x,\\
\dot{y} &amp; = v_y,\\
\dot{v}_x &amp; = - \frac{G M x}{(x^2 + y^2)^{3/2}},\\
\dot{v}_y &amp; = - \frac{G M y}{(x^2 + y^2)^{3/2}}.
\end{aligned}\]</p><p>For concreteness, we fix <span>$\mu = G M = 1$</span>. The coordinates <span>$x$</span> and <span>$y$</span> are the relative coordinates (to the center of mass) of the particle, and <span>$v_x$</span> and <span>$v_y$</span> its velocity. The function <code>kepler_eqs!</code> <em>mutates</em> the vectors corresponding to the LHS of the equations of motion.</p><pre><code class="language-julia hljs">function kepler_eqs!(dq, q, params, t)
    dq[1] = q[3]
    dq[2] = q[4]
    rr = ( q[1]^2 + q[2]^2 )^(3/2)
    dq[3] = - q[1] / rr
    dq[4] = - q[2] / rr
end;</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">kepler_eqs! (generic function with 1 method)</code></pre><p>For suitable initial conditions (such that the total energy is negative) the solutions are ellipses with one focus at the origin, which can be parameterized in terms of its semi-major axis <span>$a$</span> and its eccentricity <span>$e$</span>. We set the initial conditions for the particle at periapse, which we locate on the positive x-axis. Using the semimajor axis and the eccentricity, we write them as</p><p class="math-container">\[\begin{aligned}
x_0 &amp; = a (1-e),\\
y_0 &amp; = 0,\\
v_{x_0} &amp; = 0,\\
v_{y_0} &amp; = \frac{l_z}{x_0} = m \frac{\sqrt{\mu a (1-e^2)}}{x_0},
\end{aligned}\]</p><p>where <span>$l_z$</span> is the angular momentum. We set the mass of the particle <span>$m=1$</span>, the semi-major axis <span>$a=1$</span> and the eccentricity <span>$e=0.8$</span>. Kepler&#39;s third law defines the period of the motion as <span>$T= 2\pi a^{3/2}$</span>.</p><pre><code class="language-julia hljs">const mu = 1.0
const mass = 1.0
const aKep = 1.0
const eKep = 0.8;</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.8</code></pre><p>The initial conditions are then set using <code>ini_cond</code></p><pre><code class="language-julia hljs">function ini_cond(a, e)
    x0  = a*(one(e)-e)
    vy0 = mass * sqrt( mu * a * (1-e^2) ) / x0
    y0  = zero(vy0)
    vx0 = zero(vy0)
    return [x0, y0, vx0, vy0]
end
q0 = ini_cond(aKep, eKep)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">4-element Vector{Float64}:
 0.19999999999999996
 0.0
 0.0
 3.0</code></pre><p>We now perform the integration, using a 25 order expansion and absolute tolerance of <span>$10^{-20}$</span>.</p><pre><code class="language-julia hljs">using TaylorIntegration, Plots
t, q = taylorinteg(kepler_eqs!, q0, 0.0, 10000*2pi, 25, 1.0e-20, maxsteps=700_000);
t[end], q[end,:]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(62831.853071795864, [0.20000000000001486, 5.940560592488514e-9, -4.950456454488883e-8, 2.9999999999999])</code></pre><p>We first plot the orbit. (For performance reasons only the first 10000 points are considered.)</p><pre><code class="language-julia hljs">x = view(q, :, 1)
y = view(q, :, 2)
vx = view(q, :, 3)
vy = view(q, :, 4)
plot(x[1:10_000], y[1:10_000], legend=false)
scatter!([0], [0], shape=:circle, ms=5)
xaxis!(&quot;x&quot;, (-2.0, 0.5))
yaxis!(&quot;y&quot;, (-1.0, 1.0))
title!(&quot;Fig. 1&quot;)</code></pre><img src="5657ac54.svg" alt="Example block output"/><p>The following functions allow us to calculate the energy and angular momentum using cartesian coordinates.</p><pre><code class="language-julia hljs">function energy( x, y, vx, vy )
    kinetic = 0.5 * (vx*vx + vy*vy)
    r = sqrt( x*x + y*y)
    potential = - mu * mass / r
    return kinetic + potential
end
lz( x, y, vx, vy ) = mass * ( x*vy - y*vx ) ;</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">lz (generic function with 1 method)</code></pre><p>We use the change in energy and angular momentum of the orbit with respect to the initial value of the corresponding quantity as a function of time. These quantities are expressed in units of the <em>local epsilon</em> of the initial energy or angular momentum, respectively. This serves to illustrate the accuracy of the calculation, shown in Figure 2 and 3.</p><pre><code class="language-julia hljs">e0 = energy(q0...)
δE = (energy.(x,y,vx,vy) .- e0) ./ eps(e0)
plot(t[1:3:end], δE[1:3:end])
xlabel!(&quot;t&quot;)
ylabel!(&quot;dE&quot;)
title!(&quot;Fig. 2&quot;)</code></pre><img src="049a3f8b.svg" alt="Example block output"/><pre><code class="language-julia hljs">lz0 = lz(q0...)
δlz = (lz.(x,y,vx,vy) .- lz0) ./ eps(lz0)
plot(t[1:3:end], δlz[1:3:end])
xlabel!(&quot;t&quot;)
ylabel!(&quot;dlz&quot;)
title!(&quot;Fig. 3&quot;)</code></pre><img src="06ba8a0e.svg" alt="Example block output"/><p>These errors are reminiscent of random walks.</p><p>The maximum <em>absolute</em> errors of the energy and angular momentum are</p><pre><code class="language-julia hljs">maximum( abs.(energy.(x,y,vx,vy) .- e0) ), maximum( abs.(lz.(x,y,vx,vy) .- lz0) )</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(9.947598300641403e-14, 2.808864252301646e-14)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../simple_example/">« Infinity in finite time</a><a class="docs-footer-nextpage" href="../lorenz_lyapunov/">Lyapunov spectrum of Lorenz system »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Saturday 10 February 2024 12:32">Saturday 10 February 2024</span>. Using Julia version 1.10.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
